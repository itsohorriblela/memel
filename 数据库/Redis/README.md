# watch命令

redis支持事务， 在 Redis 中使用 watch 命令可以决定事务是执行还是回滚。

一般而言，可以在 multi 命令之前使用 watch 命令监控某些键值对，然后使用 multi 命令开启事务，执行各类对数据结构进行操作的命令，这个时候这些命令就会进入队列。   

当 Redis 使用 exec 命令执行事务的时候，它首先会去比对被 watch 命令所监控的键值对，  

- 如果没有发生变化，那么它会执行事务队列中的命令，提交事务；  

- 如果发生变化，那么它不会执行任何事务中的命令，而去事务回滚。  

无论事务是否回滚 ， Redis 都会去取消执行事务前的 watch 命令  


实际上这是一种乐观锁的机制。  

